---
title: Отладка высокой загрузкой процессора
date: 2025-07-05
description: Отладка высокой загрузкой процессора.
draft:  false
categories:
  -  linux
tags:
  - high cpu usage
---

Появилась проблема - компьютер стал постоянно работать с включенным вентилятором. Как решать эту проблему и что нужно диагностировать?

Проблема появилась после [перехода на Arch Linux](https://daybydayz.ru/entry/2025-06-26-%D0%BF%D0%B5%D1%80%D0%B5%D1%85%D0%BE%D0%B4-%D1%81-manjaro-%D0%BD%D0%B0-arch/). В процессе перехода были установлены новые драйвера vulkan на видеокарту. Повлиял ли переход, драйвера или просто совпали обстоятельства было не понятно.

По умолчанию стояло ядро linux-zen. Начал смотреть температуру. Она была около 80 градусов. Попробовал использовать разные ядра linux, linux-zen, не помогло. Попытался определить и удалить пакеты связанные с vulkan. Они все нужные оказались. По крайней мере для моего любимого редактора zed нужен vulkan. У меня встроенное gpu intel, поэтому смотрел загрузку gpu через `sudo intel_gpu_top` из пакета `intel-gpu-tools`. Загрузка временами быть большая и я грешил на zed, так как он активно использует графический ускоритель.

Надо было понять что грузит основной cpu на низком уровне. В `htop` все выглядело нормально.

Поставил `sudo pacman -S lm_sensors`. Прошел конфигурацию `sudo sensors-detect`. Проверил `sensors` температура процессора была выше нормы.

Поставил powertop `sudo pacman -S powertop` и это оказалось то что нужно(!). Там сразу привлек внимание процесс `idma64.0`. Начал гуглить и на [reddit](https://www.reddit.com/r/linux4noobs/comments/17sm93y/issues_with_cpu_usage_using_laptop_touchpad/) где ситуация была один в один с моей. Проблема была в ядре которое использовалось. Получается что последнее ядро 6.15.3 в Arch Linux на момент расследования было с дефектом. Когда я откатился на linux-lts ядро загрузка процессора нормализовалась. В Manjaro такого ни было не было даже на последних ядрах. Наглядно видно разница в подходах в разных дистрибутивах. Хотя, повторюсь, возможно совпали обстоятельства.
